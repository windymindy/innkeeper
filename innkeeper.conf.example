# Innkeeper Configuration File
# HOCON format (Human-Optimized Config Object Notation)
# https://github.com/lightbend/config/blob/master/HOCON.md

# Discord Configurations
discord {
  # Paste the Discord Token below
  # Or set the DISCORD_TOKEN environment variable (this is useful if you want to keep sensitive information out of the config file).
  # Get this from https://discord.com/developers/applications
  token=${?DISCORD_TOKEN}

  # Enable dot commands (messages starting with . are sent directly to WoW)
  # Useful for WoW commands like .gm on, .tele, etc.
  enable_dot_commands=true

  # List of server (dot) commands that are explicitly enabled
  # Leaving this as empty means ALL commands are enabled/disabled based on "enable_dot_commands" setting.
  # The commands here should reflect exactly how the command is input in game. Do not prepend the dot character.
  # We can also accept wildcards like "lookup *" or "pinfo *"
  dot_commands_whitelist=[
    #"server info"
    #"lookup *"
  ]

  # List of Discord channels where commands are enabled. If this is unspecified or empty,
  # ALL channels will have command permissions.
  enable_commands_channels=[

  ]

  # If a tag matching fails from Discord when someone @ a non-existent or unmatched person or role,
  # the bot will whisper back notifying so.
  enable_tag_failed_notifications=true
}

# WoW Configurations
wow {
  # Realm list server address (can include port, e.g., "logon.server.com:3724")
  realmlist=logon.project-ascension.com

  # Realm name to connect to (must match exactly as shown in-game)
  realm="Laughing Skull"

  # Account credentials (or use WOW_ACCOUNT/WOW_PASSWORD env vars)
  account=${?WOW_ACCOUNT}
  password=${?WOW_PASSWORD}

  # Character name to login with (or use WOW_CHARACTER env var)
  character=${?WOW_CHARACTER}

  # Whether to treat server's MotD message as a server SYSTEM message.
  enable_server_motd=true
}

# Guild notifications
guild {
  online {
    enabled=false
    format="`[%user] has come online.`"
  }
  offline {
    enabled=false
    format="`[%user] has gone offline.`"
  }
  promoted {
    enabled=true
    format="`[%user] has promoted [%target] to [%rank].`"
  }
  demoted {
    enabled=true
    format="`[%user] has demoted [%target] to [%rank].`"
  }
  joined {
    enabled=true
    format="`[%user] has joined the guild.`"
  }
  left {
    enabled=true
    format="`[%user] has left the guild.`"
  }
  removed {
    enabled=true
    format="`[%target] has been kicked out of the guild by [%user].`"
  }
  motd {
    enabled=true
    format="`Guild Message of the Day: %message`"
  }
  achievement {
    enabled=true
    format="%user has earned the achievement %achievement!"
  }
}

# Optional: Guild dashboard (shows online members in a channel)
# guild-dashboard {
#   channel=guild-online
# }

# Chat to redirect
# Note: Per-channel filters can be configured in addition to global filters!
# Priority order (first non-disabled filter wins):
# 1. Discord channel filters (highest priority, applies to BOTH directions)
# 2. WoW channel filters (applies to WoW -> Discord only)
# 3. Global filters (lowest priority, applies to all channels)
chat {
  channels=[
    {
      direction=both
      wow {
        type=Guild
        format="[%user]: %message"
      }
      discord {
        channel=guild-chat
        format="[%user]: %message"
      }
    }
    {
      direction=both
      wow {
        type=Officer
        format="[%user]: %message"
      }
      discord {
        channel=officer-chat
        format="[%user]: %message"
      }
    }
    {
      direction=wow_to_discord
      wow {
        type=Say
        format="[%user]: %message"
      }
      discord {
        channel=guild-chat
        format="[%user]: %message"
      }
    }
    {
      direction=wow_to_discord
      wow {
        type=Yell
        format="[%user]: %message"
      }
      discord {
        channel=guild-chat
        format="[%user]: %message"
      }
    }
    {
      direction=wow_to_discord
      wow {
        type=Emote
        format="%user %message"
      }
      discord {
        channel=guild-chat
        format="%user %message"
      }
    }
    {
      direction=wow_to_discord
      wow {
        type=System
        # Example: Per-channel filter on WoW side
        # filters {
        #   enabled=true
        #   patterns=[
        #     "Error 1:.*"
        #     "Welcome to.*"
        #   ]
        # }
      }
      discord {
        channel=guild-chat
        format="[SYSTEM]: %message"
        # Example: Per-channel filter on Discord side (highest priority)
        # filters {
        #   enabled=true
        #   patterns=[
        #     "(?i).*(spam|gold).*"  # Case insensitive
        #   ]
        # }
      }
    }

    # Custom channels
    {
      direction=wow_to_discord
      wow {
        type=Channel
        channel="General - Orgrimmar"
        format="[%user]: %message"
      }
      discord {
        channel=guild-chat
        format="[%target] [%user]: %message"
      }
    }
    {
      direction=wow_to_discord
      wow {
        type=Channel
        channel="Trade - City"
        format="[%user]: %message"
        # Example: Filter WoW -> Discord messages only
        filters {
          enabled=true
          patterns=[
            # Filter gold selling spam (case insensitive)
            "(?i).*((buy|sell|wts|wtb).*gold).*"
          ]
        }
      }
      discord {
        channel=trade-chat
        format="[%target] [%user]: %message"
        # No Discord-side filter, so WoW-side filter applies to WoW->Discord only
      }
    }
  ]
}

filters {
  enabled=false
  # patterns use fancy-regex syntax (Rust). Supports lookaheads, lookbehinds, and other advanced features.
  patterns=[
    # Example: case insensitive filter for messages containing all 3 words g?ld, level, and item in any order
    # ".*(?i)(?=.*g.?ld)(?=.*level)(?=.*item).*$"
    # Example: filter for messages containing >> and << in any order
    # ".*(?=.*>>)(?=.*<<).*$"
  ]
}

quirks {
  sit=false
}
